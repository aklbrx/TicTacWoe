* Rewrite things to improve readability and efficiency